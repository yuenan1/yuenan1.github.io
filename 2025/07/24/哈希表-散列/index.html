<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>å“ˆå¸Œè¡¨(æ•£åˆ—) | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="å“ˆå¸Œæ•°æ®ç»“æ„å“ˆå¸Œè¡¨çš„å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³èƒ½é€šè¿‡O(1)æ—¶é—´å¤æ‚åº¦ç›´æ¥ç´¢å¼•åˆ°æŒ‡å®šå…ƒç´ ã€‚ HashMap ä¸­çš„æ‹‰é“¾å¯»å€ + çº¢é»‘æ ‘ã€æ‰°åŠ¨å‡½æ•°ã€è´Ÿè½½å› å­ã€åˆå¹¶æ•£åˆ—ã€æœé¹ƒæ•£åˆ—ã€è·³æˆ¿å­å“ˆå¸Œã€ç½—å®¾æ±‰å“ˆå¸Œç­‰å„ç±»æ•°æ®ç»“æ„è®¾è®¡ã€‚è®©å…ƒç´ åœ¨å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œä¹Ÿå¯ä»¥å­˜æ”¾åˆ°æ–°çš„æ§½ä½ï¼Œå¹¶å°½å¯èƒ½ä¿è¯ç´¢å¼•çš„æ—¶é—´å¤æ‚åº¦å°äºO(n)  å®ç°å“ˆå¸Œæ•£åˆ—å“ˆå¸Œæ•£åˆ—æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œæ— è®ºæ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ HashMapã€ThreaLocal è¿˜æ˜¯">
<meta property="og:type" content="article">
<meta property="og:title" content="å“ˆå¸Œè¡¨(æ•£åˆ—)">
<meta property="og:url" content="http://example.com/2025/07/24/%E5%93%88%E5%B8%8C%E8%A1%A8-%E6%95%A3%E5%88%97/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="å“ˆå¸Œæ•°æ®ç»“æ„å“ˆå¸Œè¡¨çš„å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³èƒ½é€šè¿‡O(1)æ—¶é—´å¤æ‚åº¦ç›´æ¥ç´¢å¼•åˆ°æŒ‡å®šå…ƒç´ ã€‚ HashMap ä¸­çš„æ‹‰é“¾å¯»å€ + çº¢é»‘æ ‘ã€æ‰°åŠ¨å‡½æ•°ã€è´Ÿè½½å› å­ã€åˆå¹¶æ•£åˆ—ã€æœé¹ƒæ•£åˆ—ã€è·³æˆ¿å­å“ˆå¸Œã€ç½—å®¾æ±‰å“ˆå¸Œç­‰å„ç±»æ•°æ®ç»“æ„è®¾è®¡ã€‚è®©å…ƒç´ åœ¨å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œä¹Ÿå¯ä»¥å­˜æ”¾åˆ°æ–°çš„æ§½ä½ï¼Œå¹¶å°½å¯èƒ½ä¿è¯ç´¢å¼•çš„æ—¶é—´å¤æ‚åº¦å°äºO(n)  å®ç°å“ˆå¸Œæ•£åˆ—å“ˆå¸Œæ•£åˆ—æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œæ— è®ºæ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ HashMapã€ThreaLocal è¿˜æ˜¯">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-07-24T07:48:47.000Z">
<meta property="article:modified_time" content="2025-07-25T01:28:06.301Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="æ•°æ®ç»“æ„">
<meta property="article:tag" content="é‡ç‚¹">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-å“ˆå¸Œè¡¨-æ•£åˆ—" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/24/%E5%93%88%E5%B8%8C%E8%A1%A8-%E6%95%A3%E5%88%97/" class="article-date">
  <time class="dt-published" datetime="2025-07-24T07:48:47.000Z" itemprop="datePublished">2025-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%9F%BA%E7%A1%80/">åŸºç¡€</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      å“ˆå¸Œè¡¨(æ•£åˆ—)
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="å“ˆå¸Œæ•°æ®ç»“æ„"><a href="#å“ˆå¸Œæ•°æ®ç»“æ„" class="headerlink" title="å“ˆå¸Œæ•°æ®ç»“æ„"></a>å“ˆå¸Œæ•°æ®ç»“æ„</h4><p>å“ˆå¸Œè¡¨çš„å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³èƒ½é€šè¿‡O(1)æ—¶é—´å¤æ‚åº¦ç›´æ¥ç´¢å¼•åˆ°æŒ‡å®šå…ƒç´ ã€‚</p>
<p>HashMap ä¸­çš„æ‹‰é“¾å¯»å€ + çº¢é»‘æ ‘ã€æ‰°åŠ¨å‡½æ•°ã€è´Ÿè½½å› å­ã€åˆå¹¶æ•£åˆ—ã€æœé¹ƒæ•£åˆ—ã€è·³æˆ¿å­å“ˆå¸Œã€ç½—å®¾æ±‰å“ˆå¸Œç­‰å„ç±»æ•°æ®ç»“æ„è®¾è®¡ã€‚è®©å…ƒç´ åœ¨å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œä¹Ÿå¯ä»¥å­˜æ”¾åˆ°æ–°çš„æ§½ä½ï¼Œå¹¶å°½å¯èƒ½ä¿è¯ç´¢å¼•çš„æ—¶é—´å¤æ‚åº¦å°äºO(n)</p>
<hr>
<h4 id="å®ç°å“ˆå¸Œæ•£åˆ—"><a href="#å®ç°å“ˆå¸Œæ•£åˆ—" class="headerlink" title="å®ç°å“ˆå¸Œæ•£åˆ—"></a>å®ç°å“ˆå¸Œæ•£åˆ—</h4><p>å“ˆå¸Œæ•£åˆ—æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œæ— è®ºæ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ HashMapã€ThreaLocal è¿˜æ˜¯ä½ åœ¨åˆ·é¢˜ä¸­ä½äº†æå‡ç´¢å¼•æ•ˆç‡ï¼Œéƒ½ä¼šç”¨åˆ°å“ˆå¸Œæ•£åˆ—ã€‚</p>
<p>åªè¦å“ˆå¸Œæ¡¶çš„é•¿åº¦ç”±è´Ÿè½½å› å­æ§åˆ¶çš„åˆç†ï¼Œæ¯æ¬¡æŸ¥æ‰¾å…ƒç´ çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸æ¡¶ä¸­å­˜å‚¨çš„å…ƒç´ æ•°é‡æ— å…³ã€‚å¦å¤–è®¸å¤šå“ˆå¸Œè¡¨è®¾è®¡è¿˜å…è®¸å¯¹é”®å€¼å¯¹çš„ä»»æ„æ’å…¥å’Œåˆ é™¤ï¼Œæ¯æ¬¡æ“ä½œçš„æ‘Šé”€å›ºå®šå¹³å‡æˆæœ¬ã€‚</p>
<ul>
<li><em><strong>å“ˆå¸Œç¢°æ’</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šé€šè¿‡æ¨¡æ‹Ÿç®€å• HashMap å®ç°ï¼Œå»æ‰æ‹‰é“¾å¯»å€ç­‰è®¾è®¡ï¼ŒéªŒè¯å…ƒç´ å“ˆå¸Œç´¢å¼•ä½ç½®ç¢°æ’ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap01</span>&lt;K, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object[] tab = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        tab[idx] = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> (V) tab[idx];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>HashMap01 çš„å®ç°åªæ˜¯é€šè¿‡å“ˆå¸Œè®¡ç®—å‡ºçš„ä¸‹æ ‡ï¼Œæ•£åˆ—å­˜æ”¾åˆ°å›ºå®šçš„æ•°ç»„å†…ã€‚é‚£ä¹ˆè¿™æ ·å½“å‘ç”Ÿå…ƒç´ ä¸‹æ ‡ç¢°æ’æ—¶ï¼ŒåŸæœ‰çš„å…ƒç´ å°±ä¼šè¢«æ–°çš„å…ƒç´ æ›¿æ¢æ‰ã€‚</li>
</ul>
<ul>
<li><em><strong>æ‹‰é“¾å¯»å€</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šæ—¢ç„¶æˆ‘ä»¬æ²¡æ³•æ§åˆ¶å…ƒç´ ä¸ç¢°æ’ï¼Œä½†æˆ‘ä»¬å¯ä»¥å¯¹ç¢°æ’åçš„å…ƒç´ è¿›è¡Œç®¡ç†ã€‚æ¯”å¦‚åƒ HashMap ä¸­æ‹‰é“¾æ³•ä¸€æ ·ï¼ŒæŠŠç¢°æ’çš„å…ƒç´ å­˜æ”¾åˆ°é“¾è¡¨ä¸Šã€‚è¿™é‡Œæˆ‘ä»¬å°±æ¥ç®€åŒ–å®ç°ä¸€ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap02BySeparateChaining</span>&lt;K, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LinkedList&lt;Node&lt;K, V&gt;&gt;[] tab = <span class="keyword">new</span> <span class="title class_">LinkedList</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tab[idx] == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">/*å¦‚æœè¯¥ä½ç½®è¿˜æ²¡æœ‰é“¾è¡¨ï¼Œå°±æ–°å»ºä¸€ä¸ªé“¾è¡¨å¹¶æ·»åŠ èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">			å¦‚æœå·²ç»æœ‰é“¾è¡¨ï¼Œç›´æ¥æŠŠæ–°èŠ‚ç‚¹åŠ åˆ°é“¾è¡¨æœ«å°¾ã€‚</span></span><br><span class="line"><span class="comment">			æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰å»é‡ï¼ˆåŒä¸€ä¸ª key ä¼šé‡å¤æ’å…¥ï¼‰ã€‚*/</span></span><br><span class="line">            tab[idx] = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">            tab[idx].add(<span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tab[idx].add(<span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="comment">/*è®¡ç®— key çš„å“ˆå¸Œå€¼ï¼Œæ‰¾åˆ°å¯¹åº”é“¾è¡¨ã€‚</span></span><br><span class="line"><span class="comment">		éå†é“¾è¡¨ï¼Œæ‰¾åˆ° key ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œè¿”å›å…¶ valueã€‚</span></span><br><span class="line"><span class="comment">		å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¿”å› nullã€‚*/</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;K, V&gt; kvNode : tab[idx]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key.equals(kvNode.getKey())) &#123;</span><br><span class="line">                <span class="keyword">return</span> kvNode.value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K, V&gt; &#123;</span><br><span class="line">        <span class="keyword">final</span> K key;</span><br><span class="line">        V value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> K <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> V <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å› ä¸ºå…ƒç´ åœ¨å­˜æ”¾åˆ°å“ˆå¸Œæ¡¶ä¸Šæ—¶ï¼Œå¯èƒ½å‘ç”Ÿä¸‹æ ‡ç´¢å¼•è†¨èƒ€ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æŠŠæ¯ä¸€ä¸ªå…ƒç´ éƒ½è®¾å®šæˆä¸€ä¸ª Node èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹é€šè¿‡ LinkedList é“¾è¡¨å…³è”ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ Node èŠ‚ç‚¹æ„å»ºå‡ºé“¾è¡¨ next å…ƒç´ å³å¯ã€‚</li>
<li>é‚£ä¹ˆè¿™æ—¶å€™åœ¨å‘ç”Ÿå…ƒç´ ç¢°æ’ï¼Œç›¸åŒä½ç½®çš„å…ƒç´ å°±éƒ½è¢«å­˜æ”¾åˆ°é“¾è¡¨ä¸Šäº†ï¼Œè·å–çš„æ—¶å€™éœ€è¦å¯¹å­˜æ”¾å¤šä¸ªå…ƒç´ çš„é“¾è¡¨è¿›è¡Œéå†è·å–ã€‚</li>
</ul>
<ul>
<li><em><strong>å¼€æ”¾å¯»å€</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šé™¤äº†å¯¹å“ˆå¸Œæ¡¶ä¸Šç¢°æ’çš„ç´¢å¼•å…ƒç´ è¿›è¡Œæ‹‰é“¾å­˜æ”¾ï¼Œè¿˜æœ‰ä¸å¼•å…¥æ–°çš„é¢å¤–çš„æ•°æ®ç»“æ„ï¼Œåªæ˜¯åœ¨å“ˆå¸Œæ¡¶ä¸Šå­˜æ”¾ç¢°æ’å…ƒç´ çš„æ–¹å¼ã€‚å®ƒå«å¼€æ”¾å¯»å€ï¼Œä¹Ÿå°±æ˜¯ ThreaLocal ä¸­è¿ç”¨æ–æ³¢é‚£å¥‘æ•£åˆ—+å¼€æ”¾å¯»å€çš„å¤„ç†æ–¹å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap03ByOpenAddressing</span>&lt;K, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Node&lt;K, V&gt;[] tab = <span class="keyword">new</span> <span class="title class_">Node</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tab[idx] == <span class="literal">null</span>) &#123;</span><br><span class="line">            tab[idx] = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœè¯¥ä½ç½®å·²è¢«å ç”¨ï¼ˆå“ˆå¸Œå†²çªï¼‰ï¼Œåˆ™å‘åçº¿æ€§æ¢æŸ¥ï¼Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªç©ºä½æ’å…¥ã€‚</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> idx; i &lt; tab.length; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tab[i] == <span class="literal">null</span>) &#123;</span><br><span class="line">                    tab[i] = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> idx; i &lt; tab.length; i ++)&#123;</span><br><span class="line">            <span class="comment">//ä» idx å¼€å§‹å‘åçº¿æ€§æŸ¥æ‰¾ï¼Œé‡åˆ° key ç›¸ç­‰çš„èŠ‚ç‚¹å°±è¿”å› valueã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (tab[idx] != <span class="literal">null</span> &amp;&amp; tab[idx].key == key) &#123;</span><br><span class="line">                <span class="keyword">return</span> tab[idx].value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K, V&gt; &#123;</span><br><span class="line">        <span class="keyword">final</span> K key;</span><br><span class="line">        V value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€æ”¾å¯»å€çš„è®¾è®¡ä¼šå¯¹ç¢°æ’çš„å…ƒç´ ï¼Œå¯»æ‰¾å“ˆå¸Œæ¡¶ä¸Šæ–°çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®ä»å½“å‰ç¢°æ’ä½ç½®å¼€å§‹å‘åå¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºçš„ä½ç½®å­˜æ”¾ã€‚</li>
<li>åœ¨ ThreadLocal çš„å®ç°ä¸­ä¼šä½¿ç”¨æ–æ³¢é‚£å¥‘æ•£åˆ—ã€ç´¢å¼•è®¡ç®—ç´¯åŠ ã€å¯å‘å¼æ¸…ç†ã€æ¢æµ‹å¼æ¸…ç†ç­‰æ“ä½œï¼Œä»¥ä¿è¯å°½å¯èƒ½å°‘çš„ç¢°æ’ã€‚</li>
</ul>
<ul>
<li><em><strong>åˆå¹¶æ•£åˆ—</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šåˆå¹¶æ•£åˆ—æ˜¯å¼€æ”¾å¯»å€å’Œå•ç‹¬é“¾æ¥çš„æ··åˆï¼Œç¢°æ’çš„èŠ‚ç‚¹åœ¨å“ˆå¸Œè¡¨ä¸­é“¾æ¥ã€‚æ­¤ç®—æ³•é€‚åˆå›ºå®šåˆ†é…å†…å­˜çš„å“ˆå¸Œæ¡¶ï¼Œé€šè¿‡å­˜æ”¾å…ƒç´ æ—¶è¯†åˆ«å“ˆå¸Œæ¡¶ä¸Šçš„æœ€å¤§ç©ºæ§½ä½æ¥è§£å†³åˆå¹¶å“ˆå¸Œä¸­çš„å†²çªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap04ByCoalescedHashing</span>&lt;K, V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Node&lt;K, V&gt;[] tab = <span class="keyword">new</span> <span class="title class_">Node</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tab[idx] == <span class="literal">null</span>) &#123;</span><br><span class="line">            tab[idx] = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="comment">//ä»æ•°ç»„æœ«å°¾å‘å‰æ‰¾ä¸€ä¸ªç©ºä½ï¼ˆcursorï¼‰ï¼Œæ’å…¥æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">		<span class="comment">//ç„¶ååœ¨åŸå†²çªé“¾çš„æœ«å°¾ï¼Œå°†idxOfNextæŒ‡å‘æ–°èŠ‚ç‚¹çš„ä¸‹æ ‡ï¼ˆcursorï¼‰ï¼Œå½¢æˆâ€œé“¾â€ã€‚</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">cursor</span> <span class="operator">=</span> tab.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (tab[cursor] != <span class="literal">null</span> &amp;&amp; tab[cursor].key != key) &#123;</span><br><span class="line">            --cursor;</span><br><span class="line">        &#125;</span><br><span class="line">        tab[cursor] = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(key, value);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ç¢°æ’èŠ‚ç‚¹æŒ‡å‘è¿™ä¸ªæ–°èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (tab[idx].idxOfNext != <span class="number">0</span>)&#123;</span><br><span class="line">            idx = tab[idx].idxOfNext;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        tab[idx].idxOfNext = cursor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> key.hashCode() &amp; (tab.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (tab[idx].key != key) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯ç›®æ ‡ keyï¼Œå°±é¡ºç€idxOfNextè·³åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ° key ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line">            idx = tab[idx].idxOfNext;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tab[idx].value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K, V&gt; &#123;</span><br><span class="line">        <span class="keyword">final</span> K key;</span><br><span class="line">        V value;</span><br><span class="line">        <span class="type">int</span> idxOfNext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åˆå¹¶æ•£åˆ—çš„æœ€å¤§ç›®çš„åœ¨äºå°†ç¢°æ’å…ƒç´ é“¾æ¥èµ·æ¥ï¼Œé¿å…å› ä¸ºéœ€è¦å¯»æ‰¾ç¢°æ’å…ƒç´ æ‰€å‘ç”Ÿçš„å¾ªç¯éå†ã€‚ä¹Ÿå°±æ˜¯Aã€Bå…ƒç´ å­˜æ”¾æ—¶å‘ç”Ÿç¢°æ’ï¼Œé‚£ä¹ˆåœ¨æ‰¾åˆ°Aå…ƒç´ çš„æ—¶å€™å¯ä»¥å¾ˆå¿«çš„ç´¢å¼•åˆ°Bå…ƒç´ æ‰€åœ¨çš„ä½ç½®ã€‚</p>
</li>
<li><p>ç›¸å¯¹äºç›´æ¥ä½¿ç”¨å¼€æ”¾å¯»å€ï¼Œè¿™æ ·çš„æŒ‚åœ¨é“¾è·¯æŒ‡å‘çš„æ–¹å¼ï¼Œå¯ä»¥æå‡ç´¢å¼•çš„æ€§èƒ½ã€‚å› ä¸ºåœ¨å®é™…çš„æ•°æ®å­˜å‚¨ä¸Šï¼Œå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®ä¸ä¸€å®šç©ºå…ƒç´ ï¼Œå¯èƒ½å·²ç»è¢«å…¶ä»–å…ƒç´ å æ®ï¼Œè¿™æ ·å°±å¢åŠ äº†ç´¢å¼•çš„æ¬¡æ•°ã€‚æ‰€ä»¥ä½¿ç”¨ç›´æ¥æŒ‡å‘åœ°å€çš„æ–¹å¼ï¼Œä¼šæ›´å¥½çš„æé«˜ç´¢å¼•æ€§èƒ½ã€‚</p>
</li>
</ul>
<ul>
<li><em><strong>æœé¹ƒæ•£åˆ—</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šè¿™ä¸ªåå­—èµ·çš„æ¯”è¾ƒæœ‰æ„æ€ï¼Œä¹Ÿä»£è¡¨ç€å®ƒçš„æ•°æ®ç»“æ„ã€‚æœé¹ƒé¸Ÿåœ¨å­µåŒ–ğŸ£çš„æ—¶å€™ï¼Œé›é¸Ÿä¼šå°†å…¶ä»–è›‹æˆ–å¹¼å´½æ¨å‡ºå·¢ç©´ï¼›ç±»ä¼¼çš„è¿™ä¸ªæ•°æ®ç»“æ„ä¼šä½¿ç”¨2ç»„keyå“ˆå¸Œè¡¨ï¼Œå°†å†²çªå…ƒç´ æ¨åˆ°å¦å¤–ä¸€ä¸ªkeyå“ˆå¸Œè¡¨ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> V <span class="title function_">put</span><span class="params">(K key, V value, <span class="type">boolean</span> isRehash)</span> &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">k</span> <span class="operator">=</span> maskNull(key);</span><br><span class="line">    <span class="keyword">if</span> (containsKey(k)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (insertEntry(<span class="keyword">new</span> <span class="title class_">Entry</span>&lt;K, V&gt;((K) k, value))) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isRehash) &#123;</span><br><span class="line">            size++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rehash(<span class="number">2</span> * table.length);</span><br><span class="line">    <span class="keyword">return</span> put((K) k, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">insertEntry</span><span class="params">(Entry&lt;K, V&gt; e)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    Entry&lt;K, V&gt; current = e;</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(hash1, current.key);</span><br><span class="line">    <span class="keyword">while</span> (current != e || count &lt; table.length) &#123;</span><br><span class="line">        Entry&lt;K, V&gt; temp = table[index];</span><br><span class="line">        <span class="keyword">if</span> (temp == <span class="literal">null</span>) &#123;</span><br><span class="line">            table[index] = current;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        table[index] = current;</span><br><span class="line">        current = temp;</span><br><span class="line">        <span class="keyword">if</span> (index == hash(hash1, current.key)) &#123;</span><br><span class="line">            index = hash(hash2, current.key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            index = hash(hash1, current.key);</span><br><span class="line">        &#125;</span><br><span class="line">        ++count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å½“å¤šä¸ªé”®æ˜ å°„åˆ°åŒä¸€ä¸ªå•å…ƒæ ¼æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚æœé¹ƒæ•£åˆ—çš„åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡ä½¿ç”¨ä¸¤ä¸ªæ•£åˆ—å‡½æ•°è€Œä¸æ˜¯ä»…ä¸€ä¸ªæ•£åˆ—å‡½æ•°æ¥è§£å†³å†²çªã€‚</li>
<li>è¿™ä¸ºæ¯ä¸ªé”®åœ¨å“ˆå¸Œè¡¨ä¸­æä¾›äº†ä¸¤ä¸ªå¯èƒ½çš„ä½ç½®ã€‚åœ¨è¯¥ç®—æ³•çš„ä¸€ç§å¸¸ç”¨å˜ä½“ä¸­ï¼Œå“ˆå¸Œè¡¨è¢«åˆ†æˆä¸¤ä¸ªå¤§å°ç›¸ç­‰çš„è¾ƒå°çš„è¡¨ï¼Œæ¯ä¸ªå“ˆå¸Œå‡½æ•°éƒ½ä¸ºè¿™ä¸¤ä¸ªè¡¨ä¹‹ä¸€æä¾›ç´¢å¼•ã€‚ä¸¤ä¸ªæ•£åˆ—å‡½æ•°ä¹Ÿå¯ä»¥ä¸ºå•ä¸ªè¡¨æä¾›ç´¢å¼•ã€‚</li>
<li>åœ¨å®è·µä¸­ï¼Œæœé¹ƒå“ˆå¸Œæ¯”çº¿æ€§æ¢æµ‹æ…¢çº¦ 20-30%ï¼Œçº¿æ€§æ¢æµ‹æ˜¯å¸¸ç”¨æ–¹æ³•ä¸­æœ€å¿«çš„ã€‚ç„¶è€Œï¼Œç”±äºå®ƒå¯¹æœç´¢æ—¶é—´çš„æœ€åæƒ…å†µä¿è¯ï¼Œå½“éœ€è¦å®æ—¶å“åº”ç‡æ—¶ï¼Œæœé¹ƒæ•£åˆ—ä»ç„¶å¾ˆæœ‰ä»·å€¼ã€‚æœé¹ƒæ•£åˆ—çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒçš„æ— é“¾æ¥åˆ—è¡¨å±æ€§ï¼Œéå¸¸é€‚åˆ GPU å¤„ç†ã€‚</li>
</ul>
<ul>
<li><em><strong>è·³æˆ¿å­æ•£åˆ—</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šè·³æˆ¿å­æ•£åˆ—æ˜¯ä¸€ç§åŸºäºå¼€æ”¾å¯»å€çš„ç®—æ³•ï¼Œå®ƒç»“åˆäº†æœé¹ƒæ•£åˆ—ã€çº¿æ€§æ¢æµ‹å’Œé“¾æ¥çš„å…ƒç´ ï¼Œé€šè¿‡æ¡¶é‚»åŸŸçš„æ¦‚å¿µâ€”â€”ä»»ä½•ç»™å®šå ç”¨æ¡¶å‘¨å›´çš„åç»­æ¡¶ï¼Œä¹Ÿç§°ä¸ºâ€œè™šæ‹Ÿâ€æ¡¶ã€‚â€Šè¯¥ç®—æ³•æ—¨åœ¨åœ¨å“ˆå¸Œè¡¨çš„è´Ÿè½½å› å­å¢é•¿è¶…è¿‡ 90% æ—¶æä¾›æ›´å¥½çš„æ€§èƒ½ï¼›å®ƒè¿˜åœ¨å¹¶å‘è®¾ç½®ä¸­æä¾›äº†é«˜ååé‡ï¼Œå› æ­¤éå¸¸é€‚åˆå®ç°å¯è°ƒæ•´å¤§å°çš„å¹¶å‘å“ˆå¸Œè¡¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insert</span><span class="params">(AnyType x)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">currentPos</span> <span class="operator">=</span> findPos(x);</span><br><span class="line">    <span class="keyword">if</span> (currentPos == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (array[currentPos] != <span class="literal">null</span>) &#123;</span><br><span class="line">        x = array[currentPos].element;</span><br><span class="line">        array[currentPos].isActive = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String hope;</span><br><span class="line">    <span class="keyword">if</span> (array[currentPos] != <span class="literal">null</span>) &#123;</span><br><span class="line">        hope = array[currentPos].hope;</span><br><span class="line">        x = array[currentPos].element;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hope = <span class="string">&quot;10000000&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    array[currentPos] = <span class="keyword">new</span> <span class="title class_">HashEntry</span>&lt;&gt;(x, hope, <span class="literal">true</span>);</span><br><span class="line">    theSize++;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯¥ç®—æ³•ä½¿ç”¨ä¸€ä¸ªåŒ…å«n ä¸ªæ¡¶çš„æ•°ç»„ã€‚å¯¹äºæ¯ä¸ªæ¡¶ï¼Œå®ƒçš„é‚»åŸŸæ˜¯Hä¸ªè¿ç»­æ¡¶çš„å°é›†åˆï¼ˆå³ç´¢å¼•æ¥è¿‘åŸå§‹æ•£åˆ—æ¡¶çš„é‚£äº›ï¼‰ã€‚é‚»åŸŸçš„æœŸæœ›å±æ€§æ˜¯åœ¨é‚»åŸŸçš„æ¡¶ä¸­æ‰¾åˆ°ä¸€ä¸ªé¡¹ç›®çš„æˆæœ¬æ¥è¿‘äºåœ¨æ¡¶æœ¬èº«ä¸­æ‰¾åˆ°å®ƒçš„æˆæœ¬ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ä½¿é‚»åŸŸä¸­çš„æ¡¶è½åœ¨åŒä¸€ç¼“å­˜è¡Œä¸­ï¼‰ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œé‚»åŸŸçš„å¤§å°å¿…é¡»è¶³ä»¥å®¹çº³å¯¹æ•°ä¸ªé¡¹ç›®ï¼ˆå³å®ƒå¿…é¡»å®¹çº³ log( n ) ä¸ªé¡¹ç›®ï¼‰ï¼Œä½†å¹³å‡åªèƒ½æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å¦‚æœæŸä¸ªæ¡¶çš„é‚»åŸŸè¢«å¡«æ»¡ï¼Œåˆ™è°ƒæ•´è¡¨çš„å¤§å°ã€‚</li>
</ul>
<ul>
<li><em><strong>ç½—å®¾æ±‰å“ˆå¸Œ</strong></em></li>
</ul>
<p><strong>è¯´æ˜</strong>ï¼šç½—å®¾æ±‰å“ˆå¸Œæ˜¯ä¸€ç§åŸºäºå¼€æ”¾å¯»å€çš„å†²çªè§£å†³ç®—æ³•ï¼›å†²çªæ˜¯é€šè¿‡åå‘ä»å…¶â€œåŸå§‹ä½ç½®â€ï¼ˆå³é¡¹ç›®è¢«æ•£åˆ—åˆ°çš„å­˜å‚¨æ¡¶ï¼‰æœ€è¿œæˆ–æœ€é•¿æ¢æµ‹åºåˆ—é•¿åº¦ï¼ˆPSLï¼‰çš„å…ƒç´ çš„ä½ç§»æ¥è§£å†³çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="type">Entry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(key, value);</span><br><span class="line">    <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> hash(key);</span><br><span class="line">    <span class="comment">// å…ƒç´ ç¢°æ’æ£€æµ‹</span></span><br><span class="line">    <span class="keyword">while</span> (table[idx] != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry.offset &gt; table[idx].offset) &#123;</span><br><span class="line">            <span class="comment">// å½“å‰åç§»é‡ä¸æ­¢ä¸€ä¸ªï¼Œåˆ™æŸ¥çœ‹æ¡ç›®äº¤æ¢ä½ç½®ï¼Œentry æ˜¯æ­£åœ¨æŸ¥çœ‹çš„æ¡ç›®ï¼Œå¢åŠ ç°åœ¨æœç´¢çš„äº‹ç‰©çš„åç§»é‡å’Œ idx</span></span><br><span class="line">            <span class="type">Entry</span> <span class="variable">garbage</span> <span class="operator">=</span> table[idx];</span><br><span class="line">            table[idx] = entry;</span><br><span class="line">            entry = garbage;</span><br><span class="line">            idx = increment(idx);</span><br><span class="line">            entry.offset++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (entry.offset == table[idx].offset) &#123;</span><br><span class="line">            <span class="comment">// å½“å‰åç§»é‡ä¸æ­£åœ¨æŸ¥çœ‹çš„æ£€æŸ¥é”®æ˜¯å¦ç›¸åŒï¼Œå¦‚æœæ˜¯åˆ™å®ƒä»¬äº¤æ¢å€¼ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å¢åŠ  idx å’Œåç§»é‡å¹¶ç»§ç»­</span></span><br><span class="line">            <span class="keyword">if</span> (table[idx].key.equals(key)) &#123;</span><br><span class="line">                <span class="comment">// å‘ç°ç›¸åŒå€¼</span></span><br><span class="line">                <span class="type">V</span> <span class="variable">oldVal</span> <span class="operator">=</span> table[idx].value;</span><br><span class="line">                table[idx].value = value;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                idx = increment(idx);</span><br><span class="line">                entry.offset++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å½“å‰åç§»é‡å°äºæˆ‘ä»¬æ­£åœ¨æŸ¥çœ‹çš„æˆ‘ä»¬å¢åŠ  idx å’Œåç§»é‡å¹¶ç»§ç»­</span></span><br><span class="line">            idx = increment(idx);</span><br><span class="line">            entry.offset++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å·²ç»åˆ°è¾¾äº† null æ‰€åœ¨çš„ idxï¼Œå°†æ–°/ç§»åŠ¨çš„æ”¾åœ¨è¿™é‡Œ</span></span><br><span class="line">    table[idx] = entry;</span><br><span class="line">    size++;</span><br><span class="line">    <span class="comment">// è¶…è¿‡è´Ÿè½½å› å­æ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (size &gt;= loadFactor * table.length) &#123;</span><br><span class="line">        rehash(table.length * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>09ã€12 å’Œ 01 å‘ç”Ÿå“ˆå¸Œç´¢å¼•ç¢°æ’ï¼Œè¿›è¡Œåç§»é‡è®¡ç®—è°ƒæ•´ã€‚é€šè¿‡æœ€é•¿ä½ç½®æ¢æµ‹ç¢°æ’å…ƒç´ ä½ç§»æ¥å¤„ç†ã€‚</p>
</li>
<li><p>é€šè¿‡æµ‹è¯•ç»“æœå’Œè°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ï¼Œå“ˆå¸Œç´¢å¼•å†²çªæ˜¯é€šè¿‡åå‘ä»å…¶â€œåŸå§‹ä½ç½®â€ï¼ˆå³é¡¹ç›®è¢«æ•£åˆ—åˆ°çš„å­˜å‚¨æ¡¶ï¼‰æœ€è¿œæˆ–æœ€é•¿<em>æ¢æµ‹åºåˆ—é•¿åº¦ï¼ˆPSLï¼‰çš„å…ƒç´ çš„ä½ç§»æ¥è§£å†³</em>ã€‚è¿™å—å¯ä»¥æ·»åŠ æ–­ç‚¹è°ƒè¯•éªŒè¯ã€‚</p>
</li>
</ul>
<hr>
<h4 id="å¸¸è§é¢è¯•é—®é¢˜"><a href="#å¸¸è§é¢è¯•é—®é¢˜" class="headerlink" title="å¸¸è§é¢è¯•é—®é¢˜"></a>å¸¸è§é¢è¯•é—®é¢˜</h4><ul>
<li><strong>ä»‹ç»ä¸€ä¸‹æ•£åˆ—è¡¨</strong></li>
</ul>
<p>â€‹	æ•£åˆ—è¡¨ï¼ˆHash Tableï¼‰æ˜¯ä¸€ç§åŸºäºé”®å€¼å¯¹å­˜å‚¨çš„æ•°æ®ç»“æ„ã€‚å®ƒé€šè¿‡å“ˆå¸Œå‡½æ•°å°†é”®ï¼ˆkeyï¼‰æ˜ å°„åˆ°æ•°ç»„çš„æŸä¸ªä½ç½®ï¼ˆæ¡¶æˆ–æ§½ï¼‰ï¼Œä»¥å®ç°é«˜ æ•ˆçš„æ’å…¥ã€æŸ¥æ‰¾å’Œåˆ é™¤æ“ä½œï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</p>
<ul>
<li><strong>ä¸ºä»€ä¹ˆä½¿ç”¨æ•£åˆ—è¡¨</strong></li>
</ul>
<p>â€‹	ä½¿ç”¨æ•£åˆ—è¡¨çš„ä¸»è¦åŸå› æ˜¯æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œéå¸¸é«˜æ•ˆï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œè¿œå¿«äºæ•°ç»„ã€é“¾è¡¨ç­‰ç»“æ„ã€‚</p>
<ul>
<li><strong>æ‹‰é“¾å¯»å€å’Œå¼€æ”¾å¯»å€çš„åŒºåˆ«</strong></li>
</ul>
<p>â€‹	æ‹‰é“¾æ³•ç”¨é“¾è¡¨è§£å†³å†²çªï¼Œå…ƒç´ å¯åˆ†æ•£åœ¨é“¾è¡¨ä¸­ï¼›å¼€æ”¾å¯»å€æ‰€æœ‰å…ƒç´ éƒ½åœ¨æ•°ç»„å†…ï¼Œé€šè¿‡æ¢æŸ¥ç©ºä½è§£å†³å†²çªã€‚</p>
<ul>
<li><strong>è¿˜æœ‰å…¶ä»–ä»€ä¹ˆæ–¹å¼å¯ä»¥è§£å†³æ•£åˆ—å“ˆå¸Œç´¢å¼•å†²çª</strong></li>
</ul>
<p>â€‹	å†å“ˆå¸Œæ³•:å†²çªæ—¶ï¼Œä½¿ç”¨å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—æ–°çš„ä½ç½®ï¼Œå‡å°‘èšé›†ã€‚</p>
<p>â€‹	åˆé“¾å“ˆå¸Œ:ç»“åˆæ‹‰é“¾æ³•å’Œå¼€æ”¾å¯»å€ï¼Œå°†é“¾è¡¨èŠ‚ç‚¹ä¹Ÿæ”¾åœ¨å“ˆå¸Œè¡¨æ•°ç»„ä¸­ã€‚</p>
<p>â€‹	ç½—å®¾æ±‰å“ˆå¸Œ\è·³æˆ¿å­æ•£åˆ—\æœé¹ƒæ•£åˆ—</p>
<ul>
<li><strong>å¯¹åº”çš„Javaæºç ä¸­ï¼Œå¯¹äºå“ˆå¸Œç´¢å¼•å†²çªæä¾›äº†ä»€ä¹ˆæ ·çš„è§£å†³æ–¹æ¡ˆ</strong></li>
</ul>
<p>â€‹	Javaæ ‡å‡†åº“çš„å“ˆå¸Œè¡¨ï¼ˆå¦‚ HashMapã€Hashtableã€ConcurrentHashMapï¼‰ä¸»è¦é‡‡ç”¨æ‹‰é“¾æ³•ï¼ˆé“¾è¡¨æˆ–çº¢é»‘æ ‘ï¼‰æ¥è§£å†³å“ˆå¸Œå†²çªã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/24/%E5%93%88%E5%B8%8C%E8%A1%A8-%E6%95%A3%E5%88%97/" data-id="cme8cu355000br8qq2gymhte0" data-title="å“ˆå¸Œè¡¨(æ•£åˆ—)" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">æ•°æ®ç»“æ„</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%87%8D%E7%82%B9/" rel="tag">é‡ç‚¹</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/07/25/%E5%A0%86/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          å †
        
      </div>
    </a>
  
  
    <a href="/2025/07/24/%E5%A0%86%E6%A0%88/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">å †æ ˆ</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%AB%E8%82%A1/">å…«è‚¡</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2/">åšå®¢</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80/">åŸºç¡€</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%9B%E5%BB%BA%E6%96%87%E7%AB%A0/" rel="tag">åˆ›å»ºæ–‡ç« </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7%E5%AD%A6%E4%B9%A0/" rel="tag">å·¥å…·å­¦ä¹ </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">æ•°æ®ç»“æ„</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8D%E7%82%B9/" rel="tag">é‡ç‚¹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">é¢è¯•</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E5%88%9B%E5%BB%BA%E6%96%87%E7%AB%A0/" style="font-size: 10px;">åˆ›å»ºæ–‡ç« </a> <a href="/tags/%E5%B7%A5%E5%85%B7%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">å·¥å…·å­¦ä¹ </a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 20px;">æ•°æ®ç»“æ„</a> <a href="/tags/%E9%87%8D%E7%82%B9/" style="font-size: 16.67px;">é‡ç‚¹</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 13.33px;">é¢è¯•</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/08/12/MySOL/">MySOL</a>
          </li>
        
          <li>
            <a href="/2025/08/04/JVM/">JVM</a>
          </li>
        
          <li>
            <a href="/2025/08/01/Java/">Java</a>
          </li>
        
          <li>
            <a href="/2025/07/29/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/">å¸ƒéš†è¿‡æ»¤å™¨</a>
          </li>
        
          <li>
            <a href="/2025/07/29/%E5%9B%BE/">å›¾</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>